{% extends "layouts/base.html" %}

{% block title %}
    Comparacion de ratios por promedio | AnalytiFin
{% endblock %}

{% block content %} 
    <h4 class="text-center mt-4">{{miempresa}}</h4>
    <div class="text-center fw-400 mb-3">
        Comparacion de ratios por promedio
    </div>   
<div class="table-responsive">
    <table class="table table-borderless table-hover">
        <thead>
            <th>Ratio</th>
            {% for empresa in empresas %}
            <th>{{empresa.nombre}}</th>
            {% endfor %}
            <th>promedio</th>
        </thead>
        <tbody>
            <tr>
            {% for elemento in promedios %}
            <td>{{elemento.nombre}}</td>
            {% if elemento.ratio1esMayor %}
            <td style="background-color: green;">{{ elemento.ratio1|floatformat:2 }}</td>
            {% else %}
            <td style="background-color: red;">{{ elemento.ratio1|floatformat:2 }}</td>
            {% endif %}
            {% if elemento.ratio2esMayor %}
            <td style="background-color: green;">{{ elemento.ratio2|floatformat:2 }}</td>
            {% else %}
            <td style="background-color: red;">{{ elemento.ratio2|floatformat:2 }}</td>
            {% endif %}
            <td>{{ elemento.promedio|floatformat:2 }}</td>
            </tr>
            
            {% endfor %}
        </tbody>
    </table>
</div>
    

    

    
{% endblock %}

{% block filtros%}
</br>
<form method="post" onsubmit="return validarFechas()">
    {% csrf_token %}
    <label for="fechainicio">Fecha inicial</label><br>
    <input class="form-control" type="date" id="fechainicio" name="fechainicio" {%if fecha_inicio %} value={{fecha_inicio}} {% endif %} required><br>

    <label for="fechafinal">Fecha final</label><br>
    <input class="form-control" type="date" id="fechafinal" name="fechafinal" {%if fecha_final %} value={{fecha_final}} {% endif %} required><br>
    <div class="text-center">
        <input class="btn btn-dark" type="submit" value="Generar">
    </div>
</form>
</br>
<script>
    function validarFechas() {
        var fechaInicio = new Date(document.getElementById('fechainicio').value);
        var fechaFinal = new Date(document.getElementById('fechafinal').value);
        if (fechaInicio >= fechaFinal) {
            alert('La fecha inicial debe ser menor que la fecha final');
            return false;  // Impide que el formulario se envíe
        }

        return true;  // Permite que el formulario se envíe si las fechas son válidas
    }
</script>
{% endblock %}